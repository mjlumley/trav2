0010 REM TRAVELLER SECTOR GENERATOR 
0020 REM This program is written in Applesoft Basic for the Apple 11 
0030 REM series of computers. Minor changes may be necessary (primarily 
0040 REM in disk access) for the program to work on other machines. 
0050 REM
0060 REM FROM Challenge Magazine Issue #25
0070 REM

1000 TEXT : HOME : PRlNT "TRAVELLER SECTOR GENERATOR"
1010 PRlNT " THlS PROGRAM GENERATES WORLD UPP DATA FOR TRAVELLER. COPYRIGHT (c) 1986 GAME DESIGNERS' WORKSHOP, INC. PO BOX 1646, BLOOMINGTON, IL 61702."

1100 REM SET VARIABLES
1110 HX$ = "0123456789ABCDEFGHJKLJ"
1120 SP$ = "AAAABBCCDEEX"
1130 BA$ = "ABCDEFGHJKLMNPQRSTUVWXYZ"
1140 DEF FN A(X) = INT(RND(4)* 6) + 1
1150 DEF FN B(X) = FN A(X) + FN A(X)
1160 AL$ ="IM"

1200 REM
2000 REM PRODUCE SECTOR
2010 PRlNT CHR$(4);"OPEN SECTOR, L50"
2020 FOR X = 1 TO 32
2030 FOR Y = 1 TO 40

2100 REM WORLD OCCURRENCE
2110 IF FN A(4) <4 THEN 3260

115 REM GENERATE UPP
2120 ST= FN B(4)
2130 ST$ = MID$(SP$,ST,l)
2140 SI = FN B(4) - 2
2150 AM=FN B(2)-7+SI: IF SI=0 THEN AM=0
2160 IF AM<0 THEN AM=0
2170 HY = FN B(2) - 7 + SI: IF SI < 2 THEN HY =0
2180 IF AM>2 OR AM<9 THEN HY=HY-4
2190 IF HY<0 THEN HY=0
2200 IF HY>10 THEN HY=10
2210 PO=FN B(3)-2
2220 GO = FN B(3) - 7 +PO: IF GO<0 THEN GO =0
2230 LA= FN B(4) - 7 + GO: IF LA<0 THEN LA=0
2240 TL=0
2250 IF ST$ = "A" THEN TL = TL + 6
2260 IF ST$ = "B" THEN TL=TL+4
2270 IF ST$ = "C" THEN TL= TL+ 2
2280 IF ST$ = "X" THEN TL=TL-4
2290 IF SI<5 THEN TL=TL- 1: IF SI<2 THEN TL=TL-1
2300 IF AM<4 THEN TL=TL+ 1
2310 IF AM>9 THEN TL=TL+ 1
2320 IF HY>8 THEN TL=TL+l: IF HY>9 THEN TL=TL+l
2330 IF PO>0 AND PO<6 THEN TL=TL+ 1
2340 IF P0>8 THEN TL=TL+2: IF P0>9 THEN TL=TL+2
2350 IF GO=0 OR GO=5 THEN TL=TL+ 1
2360 IF GO= 13 THEN TL=TL-2
2370 IF TL<0 THEN TL=0
2380 GG = 0

2400 REM GENERATE GAS GIANT
2410 IF FN B(4)<10 THEN GG=1

2500 REM GENERATE TRAVEL ZONES
2510 TZ=0: IF ST$ ="X" THEN TZ=2
2520 IF TZ=0 AND FN B(4)< 10 THEN TZ= 1
2530 B1= 0: IF ST$ <"B" THEN 2560
2540 IF FN B(4)> 7 THEN Bl = 1

2550 REM GENERATE BASES
2560 DM = 0
2570 B2 =0: IF ST$ ="A" THEN DM = - 3
2580 IF ST$ ="B" THEN DM = - 2
2590 IF ST$ ="C" THEN DM = - 3
2600 IF ST$ >"D" THEN 2620
2610 IF(FN B(4) + DM) <6 THEN B2 = 1
2620 B$ =" "
2630 IF B1= 1 AND B2 = 0 THEN B$ ="N"
2640 IF BI =0 AND B2 = 1 THEN B$ = "S"
2650 IF B1= 1 AND B2 = 1 THEN B$ ="A"
2660 TC$ = " "

2700 REM TRADE CLASSIFICATIONS
2720 IF(AM>3 AND AM< 10)AND(HY >3 AND HY <5)AND(PO>4 AND PO < 8)THEN TC$ = TC$ + "AG "
2730 IF AM<4 AND HY<4 AND PO>5 THEN TC$=TC$ +"NA "
2740 IF(AM < 3 OR AM = 4 OR AM = 7 OR A = 9)AND PO > 8 THEN TC$ = TC$ + "IN "
2750 IF P0<7 THEN TCS =TCS +"NI "
2760 IF(AM = 6 OR AM = 8)AND(PO> 5 AND PO < 9)AND(GO < 3 AND GO > 10)THEN TC$ = TC$ + "RI "
2770 IF(AM< 1 AND AM>6)AND HY <4 THEN TC$ =TC$ +"PO "
2780 IF HY = 10 THEN TC$ =TC$ +"WA "
2790 IF HY =0 AND AM> 1 THEN TC$ =TC$ + "DE "
2800 IF SI=0 THEN TC$ =TC$ + "AS "
2810 IF AM =0 AND SI>0 THEN TC$ =TC$ +"VA "
2820 IF PO = 0 AND GO = 0 AND LA = 0 THEN TC$ = TC$ + "BA "
2830 TC$ = LEFTS(TC$ +" ",15)

2900 REM
3000 REM CREATE WORLD DATA STRING
3010 A$=" "
3020 IF X< 10 THEN A$ ="0"
3030 A$ =A$ +STR$(X)
3040 IF Y < 10 THEN A$ =A$ + "0"
3050 A$ =A$ +STR$(Y)+" "
3060 A$ =A$+ST$ +MID$(HX$,SI+1,1)+MID$(HX$,AM+1 ,1)+MID$(HX$,HY + 1,1)+MID$(HX$,PO+ 1,1)+MID$(HX$,GO+ 1,1)+MID$(HX$,LA+1,1)+"-"+MID$(HX$,TL+ 1,1)+" "+B$+" "+TC$+AL$+" "
3120 IF TZ= 1 THEN A$=A$+"A "
3130 IF TZ=2 THEN A$=A$ +"R "
3140 IF TZ=0 THEN A$=A$+" "
3150 IF GG=0 THEN A$ =A$+" "
3160 IF GG = 1 THEN A$ =A$ +"G "

3200 REM SAVE TO DISK
3210 R=R+1
3220 PRINT CHR$(4);"WRITE SECTOR, R";R
3230 PRlNT A$
3260 NEXT Y:NEXT X

3300 REM SAVE FlLE LENGTH
3310 PRINT CHR$(4);"WRITE SECTOR, RO"
3320 PRINT R
3330 PRINT CHR$(4);"CLOSE"

4000 REM SAVE FlLE PARAMETERS
4010 INPUT "NAME THlS FILE? >";FI$
4020 PRlNT CHR$(4);"RENAME SECTOR,";FI$
4030 PRINT CHR$(4);"OPEN ";FI$;"@"
4040 PRlNT CHR$(4);"WRITE ";FI$;"@"
4050 PRlNT 9
4060 PRINT R
4070 PRlNT 49
4080 PRlNT "HEX ........ ":PRINT 4
4100 PRlNT "UPP ........" :PRINT 9
4120 PRlNT "BASES ......" :PRINT 1
4140 PRlNT "TRADE CLA..":PRINT 14
4160 PRlNT "ALLEG ......" :PRINT 2
4180 PRlNT "TRAVEL ZO..":PRINT 1
4200 PRlNT "GAS GIANT..":PRINT 1
4220 PRlNT "TRADEWRLD..":PRINT 1
4240 PRlNT "EXPLORED?..":PRINT 1
4260 PRlNT CHR$(4);"CLOSE"
4270 END

5000 REM BY MARC W. MILLER
